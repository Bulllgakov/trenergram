# Техническое задание
# Платформа Trenergram - MVP версия 2.0

## 📋 Оглавление
1. [Общее описание проекта](#общее-описание)
2. [Бизнес-модель](#бизнес-модель)
3. [Архитектура системы](#архитектура)
4. [Telegram Bot](#telegram-bot)
5. [Telegram Mini App](#mini-app)
6. [Веб-витрина](#веб-витрина)
7. [Панель администратора клуба](#панель-клуба)
8. [Админка супер-админов](#админка)
9. [База данных](#база-данных)
10. [Бизнес-логика](#бизнес-логика)
11. [Требования к реализации](#требования)
12. [Этапы разработки](#этапы)

---

## 1. Общее описание проекта {#общее-описание}

### 1.1 Цель проекта
Создание автоматизированной системы записи на фитнес-тренировки через Telegram, устраняющей необходимость ручной переписки между тренерами и клиентами. **Платформа Trenergram полностью бесплатна для тренеров и клиентов.**

### 1.2 Основные проблемы, которые решаем
- Тренеры тратят 2-3 часа в день на переписку с клиентами
- Клиенты забывают о тренировках без напоминаний
- Сложность управления расписанием и переносами
- Отсутствие гарантий оплаты при неявке
- **Клубам сложно привлекать и удерживать клиентов**
- **Отсутствие CRM для управления тренерами и клиентами**

### 1.3 Целевая аудитория
- **Тренеры:** фитнес-тренеры, работающие в залах или частно (бесплатно)
- **Клиенты:** люди, занимающиеся с персональным тренером (бесплатно)
- **Фитнес-клубы:** залы и студии (платные тарифы для расширенных функций)
- **География:** начальный запуск в одном городе с последующим масштабированием

### 1.4 Ключевые метрики успеха
- 50+ активных тренеров за первый месяц
- 10+ клубов на платных тарифах за 3 месяца
- 500+ зарегистрированных клиентов
- 1000+ успешных записей
- Сокращение времени на администрирование на 80%

---

## 2. Бизнес-модель {#бизнес-модель}

### 2.1 Принципы монетизации
**БЕСПЛАТНО ДЛЯ ВСЕХ:**
- ✅ Тренеры используют платформу бесплатно
- ✅ Клиенты записываются бесплатно
- ✅ Базовые функции для клубов бесплатно

**ПЛАТНЫЕ ТАРИФЫ ДЛЯ КЛУБОВ:**

### 2.2 Тарифные планы для клубов

#### Базовый (0₽/мес) - БЕСПЛАТНО
- Регистрация клуба на платформе
- Страница клуба в каталоге
- До 5 тренеров
- Базовая статистика
- QR-коды для привлечения клиентов

#### Стандарт (9900₽/мес)
- Все функции Базового +
- До 20 тренеров
- CRM для управления клиентами
- Расширенная статистика и аналитика
- Массовые рассылки клиентам
- Приоритетная поддержка
- Брендированные QR-коды

#### Премиум (19900₽/мес)
- Все функции Стандарт +
- Неограниченное количество тренеров
- API для интеграции
- Экспорт данных
- Персональный менеджер
- Кастомизация интерфейса
- White-label решение (обсуждается)

### 2.3 QR-коды для привлечения клиентов

**QR-коды тренеров:**
- Каждый тренер имеет персональный QR-код и ссылку
- QR ведет напрямую к профилю тренера для записи
- Доступны через команду /qr в боте
- Тренер может распечатать и разместить где угодно

**QR-коды клубов:**
- Клуб получает уникальные QR-коды для размещения
- При сканировании → страница клуба с списком тренеров
- Клиент выбирает тренера → переходит к его профилю
- Размещение: рецепция, залы, раздевалки, инфосте

нды
- Отслеживание конверсии: QR клуба → выбор тренера → запись

---

## 3. Архитектура системы {#архитектура}

### 3.1 Компоненты системы

```
┌─────────────────────────────────┐
│   АДМИНКА СУПЕР-АДМИНОВ         │
│   trenergram.ru/admin           │
└────────────┬────────────────────┘
             │
┌────────────┼────────────────────┐
│   ПАНЕЛЬ АДМИНИСТРАТОРА КЛУБА   │
│   trenergram.ru/club-admin      │
└────────────┬────────────────────┘
             │
┌────────────┼────────────────────┐
│   ВЕБ-ВИТРИНА (trenergram.ru)   │
│   Поиск и выбор тренеров        │
└────────────┬────────────────────┘
             │
      ┌──────▼──────┐
      │   API/База  │
      │   данных    │
      └──────┬──────┘
             │
    ┌────────┴────────┐
    │                 │
┌───▼───┐      ┌─────▼─────┐
│  BOT  │      │ Mini App  │
│Telegram│     │ Telegram  │
│@TrenergramBot│           │
└───┬───┘      └─────┬─────┘
    │                │
    └────┬──────┬────┘
         │      │
    Тренеры  Клиенты
```

### 3.2 Технологический стек

**Backend:**
- Python 3.10+
- python-telegram-bot 20.3
- FastAPI для API
- PostgreSQL для продакшена (SQLite для разработки)
- Redis для кеширования
- Celery для фоновых задач

**Frontend (Web):**
- React.js для админок
- HTML5/CSS3/JavaScript для витрины
- Tailwind CSS для стилизации
- Адаптивная верстка

**Frontend (Mini App):**
- HTML5/CSS3/JavaScript
- Telegram WebApp API
- Стили нативного Telegram интерфейса

**Инфраструктура:**
- VPS/VDS сервер (минимум 4GB RAM)
- SSL сертификат
- Домен trenergram.ru
- Nginx для проксирования

---

## 3.5. API Структуры данных {#api-структуры}

### Модель BookingResponse

При возврате информации о записях API включает следующие поля:

```typescript
interface BookingResponse {
  id: number;
  trainer_id: number;
  client_id: number;
  club_id?: number;
  datetime: string;
  duration: number;
  price?: number;
  status: BookingStatus;
  notes?: string;
  is_paid: boolean;
  created_at: string;

  // Дополнительные поля с информацией
  trainer_name?: string;
  client_name?: string;
  club_name?: string;

  // Telegram идентификаторы (важно!)
  trainer_telegram_id?: string;      // Telegram ID тренера
  client_telegram_id?: string;       // Telegram ID клиента
  trainer_telegram_username?: string; // Username тренера для прямой связи
}
```

### Модель UserResponse

```typescript
interface UserResponse {
  id: number;
  telegram_id: string;        // Основной идентификатор пользователя
  telegram_username?: string; // Username для прямой связи
  name: string;
  role: 'trainer' | 'client';
  phone?: string;
  email?: string;
  club_id?: number;
  specialization?: string;
  price?: number;
  description?: string;
  rating?: number;
  is_active: boolean;
  created_at: string;
}
```

**Важно:** Все операции с пользователями должны использовать `telegram_id` как основной идентификатор, а не внутренний `id`.

---

## 4. Telegram Bot (@TrenergramBot) {#telegram-bot}

### 4.1 Основные команды

#### Для всех пользователей:
- `/start` - начало работы, определение роли
- `/help` - справка по командам
- `/support` - связь с поддержкой

#### Для тренеров:

**Команды:**
- `/cabinet` - открыть кабинет тренера (команда для совместимости)
- `/my_link` - получить персональную ссылку для клиентов
- `/settings` - открыть настройки (команда для совместимости)

**Кнопки после регистрации:**
- 📱 **Открыть кабинет тренера** - открывает Mini App для тренера
- 📎 **Ссылка для клиентов** - показывает персональную ссылку
- ⚙️ **Настройки** - открывает настройки в Mini App

*Примечание: Все функции управления (расписание, клиенты, статистика) доступны через Mini App*

#### Для клиентов (после привязки к тренеру):

**Кнопки после регистрации:**
- 📱 **Мои тренировки** - открывает Mini App для клиента
- ⚙️ **Настройки** - настройки клиента (в разработке)

*Примечание: Запись, просмотр и отмена тренировок происходят через Mini App*

#### Для администраторов клубов:
- `/club_stats` - статистика клуба
- `/club_trainers` - список тренеров
- `/club_clients` - список клиентов (на платных тарифах)
- `/club_link` - ссылка на панель управления

**ВАЖНО:** Поиск тренеров через бота УБРАН. Клиенты находят тренеров только через:
- Веб-витрину trenergram.ru
- Прямую ссылку тренера
- QR-код в клубе

### 4.2 Сценарии использования

#### 4.2.1 Регистрация тренера
```
Пользователь: /start

Бот: Добро пожаловать в Trenergram!
Платформа полностью БЕСПЛАТНА для тренеров и клиентов.

Вы тренер или клиент?
[Я тренер] [Я клиент]

Пользователь: [Я тренер]

Бот: 💪 Регистрация тренера

Для регистрации нам нужны ваши контактные данные.
Нажмите кнопку ниже, чтобы поделиться контактом:

[📱 Поделиться контактом] - кнопка запроса контакта

Пользователь: [Нажимает кнопку и делится контактом]

Бот: ✅ Контакт получен!

Где вы проводите тренировки?
[Выбрать из списка клубов]
[Частный тренер]
[Онлайн]
[Добавить новый клуб]

Пользователь: [Выбирает клуб]

Бот: Стоимость одной тренировки?

Пользователь: 2000

Бот: ✅ Профиль создан!
Ваша ссылка: t.me/TrenergramBot?start=trainer_123456

Платформа Trenergram полностью БЕСПЛАТНА для вас!

[Показываются WebApp кнопки:]
📱 Открыть кабинет тренера
📎 Ссылка для клиентов
⚙️ Настройки
```

**Примечание:** Имя и телефон берутся автоматически из контакта Telegram

#### 4.2.2 Регистрация через QR-код клуба
```
Клиент: [сканирует QR в фитнес-клубе]

Бот: Добро пожаловать в Trenergram!
Вы в клубе "Фитнес ЭНЕРГИЯ"

🏢 Адрес: ул. Пушкина 15
⏰ Работаем: 07:00-23:00

Наши тренеры:
[Показывает список тренеров клуба]

[Выбрать тренера] [Все тренеры]
```

#### 4.2.3 Регистрация клиента через ссылку тренера
```
Клиент: [переходит по ссылке тренера t.me/TrenergramBot?start=trainer_123456]

Бот: Добро пожаловать в Trenergram!
Вас приглашает тренер: Иван Петров

🏃 Регистрация клиента

Для записи на тренировки нам нужны ваши контактные данные.
Нажмите кнопку ниже:

[📱 Поделиться контактом] - кнопка запроса контакта

Клиент: [Нажимает кнопку и делится контактом]

Бот: ✅ Вы успешно привязаны к тренеру Иван Петров!

Платформа Trenergram полностью БЕСПЛАТНА для вас!

[Показываются WebApp кнопки:]
📱 Мои тренировки
⚙️ Настройки
```

**Примечание:** Имя и телефон берутся автоматически из контакта Telegram

#### 4.2.4 Запись клиента тренером (сохраняется как в v1)
[Сценарий остается без изменений]

#### 4.2.5 Настройка напоминаний тренером (сохраняется как в v1)
[Сценарий остается без изменений]

---

## 5. Telegram Mini App {#mini-app}

### 5.1 Интерфейс для тренера

#### Главный экран - Расписание
```
┌────────────────────────────────┐
│ Мое расписание              📊 │
│ ✅ 5 • ⏳ 2 • ➕ 3             │
│ Клуб: Фитнес ЭНЕРГИЯ           │
├────────────────────────────────┤
│ [👥 Мои клиенты (24)]          │
│ [🔗 Моя ссылка]                │
│ [📊 Статистика]                │
│ [⚙️ Настройки]                 │
├────────────────────────────────┤
│ [Пн 12] [Вт 13] [Сегодня]     │
├────────────────────────────────┤
│ СРЕДА, 13 АВГУСТА              │
├────────────────────────────────┤
│ 09:00 Мария Сидорова ✓         │
│ 10:00 Александр Смирнов ✓      │
│ 11:00 [СВОБОДНО] +             │
│ 15:00 Иван Петров ⏳           │
│ 16:00 [СВОБОДНО] +             │
│ 17:00 Елена Козлова ✓          │
│ 18:00 @новый_клиент ⏳         │
│                                │
│        [+] Записать            │
└────────────────────────────────┘

✅ Платформа БЕСПЛАТНА для тренеров!
```

[Остальные экраны Mini App остаются как в v1]

---

## 6. Веб-витрина (trenergram.ru) {#веб-витрина}

> **Примечание:** Mini App размещен на trenergram.ru/app/ и доступен только через Telegram бота

### 6.1 Основные страницы

#### Главная страница
- **Заголовок:** "Trenergram - Бесплатная платформа для записи на тренировки"
- **Подзаголовок:** "Для тренеров и клиентов - БЕСПЛАТНО НАВСЕГДА"
- Поисковая строка
- Блок "Для клубов" с тарифами
- Статистика платформы
- Популярные тренеры
- Список клубов-партнеров

#### Каталог тренеров
- Фильтры:
  - По фитнес-клубу
  - По специализации
  - По цене (от/до)
  - По рейтингу
  - По району города
- Сортировка:
  - По рейтингу
  - По цене
  - По количеству отзывов
  - По клубу
- Карточки тренеров с указанием клуба

#### Страница клуба
- Информация о клубе
- Список тренеров клуба
- Адрес и контакты
- Расписание работы
- QR-код для быстрой записи
- Отзывы о клубе

#### Страница тарифов
- Сравнение тарифов для клубов
- Кнопка "Попробовать бесплатно"
- Форма заявки на подключение

---

## 7. Панель администратора клуба (trenergram.ru/club-admin) {#панель-клуба}

### 7.1 Функционал по тарифам

#### Базовый тариф (0₽)
```
┌─────────────────────────────────┐
│ Панель управления клубом        │
│ Фитнес ЭНЕРГИЯ                  │
│ Тариф: Базовый                  │
├─────────────────────────────────┤
│ ОСНОВНАЯ СТАТИСТИКА             │
│ • Тренеров: 5/5 (лимит)         │
│ • Клиентов: 124                 │
│ • Записей за месяц: 456         │
│                                 │
│ [Тренеры] [QR-коды] [Настройки] │
│                                 │
│ [🔝 Улучшить тариф]             │
└─────────────────────────────────┘
```

#### Стандарт (9900₽/мес)
```
┌─────────────────────────────────┐
│ CRM Панель - Фитнес ЭНЕРГИЯ    │
│ Тариф: Стандарт                │
├─────────────────────────────────┤
│ [📊 Дашборд]                    │
│ [👥 Клиенты]                    │
│ [💪 Тренеры]                    │
│ [📅 Расписание]                 │
│ [📈 Аналитика]                  │
│ [📧 Рассылки]                   │
│ [🎯 QR-коды]                    │
│ [⚙️ Настройки]                  │
├─────────────────────────────────┤
│ СЕГОДНЯШНЯЯ СТАТИСТИКА          │
│ • Новых клиентов: 5             │
│ • Записей: 34                   │
│ • Отмен: 2                      │
│ • Выручка: 68,000₽              │
└─────────────────────────────────┘
```

### 7.2 Основные разделы

#### Дашборд
- Ключевые метрики в реальном времени
- График записей по дням
- Топ тренеров по записям
- Последние действия

#### Управление клиентами (CRM)
- База клиентов с фильтрами
- История тренировок каждого клиента
- Абонементы и оплаты
- Сегментация для рассылок
- Экспорт данных (Премиум)

#### Управление тренерами
- Список тренеров клуба
- Статистика по каждому тренеру
- Расписание и загруженность
- Добавление/удаление тренеров

#### Аналитика
- Конверсия QR → запись
- Динамика роста клиентской базы
- Финансовая аналитика
- Отчеты по периодам

#### QR-коды
- Генерация QR для разных зон клуба
- Статистика сканирований
- A/B тестирование размещения

---

## 8. Админка супер-админов (trenergram.ru/admin) {#админка}

### 8.1 Основные разделы

```
┌─────────────────────────────────┐
│ Trenergram Admin Panel          │
├─────────────────────────────────┤
│ [🏢 Клубы]                      │
│ [👤 Пользователи]               │
│ [💰 Платежи]                    │
│ [📊 Статистика]                 │
│ [🎯 Маркетинг]                  │
│ [⚙️ Настройки]                  │
│ [📝 Логи]                       │
└─────────────────────────────────┘
```

### 8.2 Управление клубами
- Список всех клубов
- Тарифы и статусы оплаты
- Активация/деактивация
- История платежей
- Ручное управление тарифами

### 8.3 Управление пользователями
- Поиск по тренерам/клиентам
- Блокировка/разблокировка
- Просмотр активности
- Решение спорных ситуаций

### 8.4 Финансовая аналитика
- MRR (Monthly Recurring Revenue)
- Churn rate
- LTV клубов
- Прогнозы доходов

---

## 9. База данных {#база-данных}

### 9.1 Структура таблиц

```sql
-- Фитнес-клубы (НОВАЯ ТАБЛИЦА)
CREATE TABLE clubs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name VARCHAR(200) NOT NULL,
    address TEXT,
    district VARCHAR(100),
    metro VARCHAR(100),
    phone VARCHAR(20),
    email VARCHAR(100),
    working_hours JSON,
    tariff VARCHAR(20) DEFAULT 'basic',
    -- Тарифы: basic, standard, premium
    tariff_expires_at TIMESTAMP,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Администраторы клубов (НОВАЯ ТАБЛИЦА)
CREATE TABLE club_admins (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    club_id INTEGER NOT NULL,
    telegram_id BIGINT,
    email VARCHAR(100) NOT NULL,
    password_hash VARCHAR(255),
    name VARCHAR(200),
    role VARCHAR(20) DEFAULT 'admin',
    -- Роли: owner, admin, manager
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (club_id) REFERENCES clubs(id)
);

-- Платежи клубов (НОВАЯ ТАБЛИЦА)
CREATE TABLE club_payments (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    club_id INTEGER NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    tariff VARCHAR(20) NOT NULL,
    period_start DATE NOT NULL,
    period_end DATE NOT NULL,
    status VARCHAR(20) DEFAULT 'pending',
    -- Статусы: pending, paid, failed, refunded
    payment_method VARCHAR(50),
    transaction_id VARCHAR(100),
    paid_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (club_id) REFERENCES clubs(id)
);

-- QR-коды клубов (НОВАЯ ТАБЛИЦА)
CREATE TABLE club_qr_codes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    club_id INTEGER NOT NULL,
    code VARCHAR(100) UNIQUE NOT NULL,
    name VARCHAR(200),
    location VARCHAR(200),
    -- Например: "Рецепция", "Зал 1", "Раздевалка"
    scans_count INTEGER DEFAULT 0,
    conversions_count INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (club_id) REFERENCES clubs(id)
);

-- Тренеры (ОБНОВЛЕНО - добавлена связь с клубом)
CREATE TABLE trainers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    telegram_id BIGINT UNIQUE NOT NULL,
    telegram_username VARCHAR(100),
    name VARCHAR(200) NOT NULL,
    club_id INTEGER, -- ИЗМЕНЕНО: gym_id → club_id
    specialization JSON,
    price INTEGER DEFAULT 2000,
    description TEXT,
    rating DECIMAL(2,1) DEFAULT 5.0,
    is_active BOOLEAN DEFAULT TRUE,
    -- Настройки напоминаний
    reminder_1_hours INTEGER DEFAULT 24,
    reminder_1_time TIME DEFAULT '20:00',
    reminder_2_delay INTEGER DEFAULT 2,
    reminder_3_delay INTEGER DEFAULT 4,
    auto_cancel_delay INTEGER DEFAULT 5,
    -- Правила переноса
    transfer_block_hours INTEGER DEFAULT 24,
    -- Рабочие часы
    working_hours JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (club_id) REFERENCES clubs(id)
);

-- Клиенты (без изменений)
CREATE TABLE clients (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    telegram_id BIGINT UNIQUE NOT NULL,
    telegram_username VARCHAR(100),
    name VARCHAR(200),
    phone VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Связь клуб-клиент (НОВАЯ ТАБЛИЦА)
CREATE TABLE club_clients (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    club_id INTEGER NOT NULL,
    client_id INTEGER NOT NULL,
    source VARCHAR(50),
    -- Источники: qr_code, trainer_link, web_catalog
    qr_code_id INTEGER,
    first_visit_date DATE,
    total_bookings INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (club_id) REFERENCES clubs(id),
    FOREIGN KEY (client_id) REFERENCES clients(id),
    FOREIGN KEY (qr_code_id) REFERENCES club_qr_codes(id),
    UNIQUE(club_id, client_id)
);

-- Связь тренер-клиент (без изменений)
CREATE TABLE trainer_clients (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    trainer_id INTEGER NOT NULL,
    client_id INTEGER NOT NULL,
    first_booking_date DATE,
    last_booking_date DATE,
    total_bookings INTEGER DEFAULT 0,
    status VARCHAR(20) DEFAULT 'active',
    source VARCHAR(50),
    confirmed_at TIMESTAMP,
    invited_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (trainer_id) REFERENCES trainers(id),
    FOREIGN KEY (client_id) REFERENCES clients(id),
    UNIQUE(trainer_id, client_id)
);

-- Остальные таблицы остаются как в версии 1.3
-- (bookings, trainer_slots, invitations, profile_views)
```

### 9.2 Начальные данные для тестирования

```sql
-- Примеры клубов
INSERT INTO clubs (name, address, district, tariff) VALUES
('Фитнес ЭНЕРГИЯ', 'ул. Пушкина 15', 'Центр', 'standard'),
('World Class Тверская', 'ул. Тверская 1', 'Центр', 'premium'),
('Alex Fitness', 'пр. Мира 45', 'Север', 'basic'),
('Зал ХАРДКОР', 'пер. Спортивный 5', 'Центр', 'basic');

-- Тестовый администратор клуба
INSERT INTO club_admins (club_id, email, name, role) VALUES
(1, 'admin@energia.ru', 'Админ Энергии', 'owner');
```

---

## 10. Бизнес-логика {#бизнес-логика}

### 10.1 Процесс привлечения через QR

**Через QR-код тренера:**
1. **Тренер размещает личный QR:**
   - В своих соцсетях
   - На визитках
   - В клубе (если разрешено)
   - На рекламных материалах

2. **Клиент сканирует QR тренера:**
   - Попадает напрямую в бота @TrenergramBot
   - Видит профиль конкретного тренера
   - Может сразу записаться на тренировку
   - Происходит автоматическая привязка

**Через QR-код клуба:**
1. **Клуб размещает QR-коды:**
   - На рецепции (основной)
   - В тренажерных залах
   - В раздевалках
   - На информационных стендах

2. **Клиент сканирует QR клуба:**
   - Попадает на страницу клуба в боте
   - Видит информацию о клубе
   - Видит список всех тренеров клуба
   - Выбирает тренера → переходит к его профилю
   - Может посмотреть QR/ссылку конкретного тренера

3. **Отслеживание конверсии:**
   - Для тренера: прямые переходы по его QR/ссылке
   - Для клуба: сканирования QR → выбор тренера → запись
   - Клуб видит статистику в админке по источникам

### 10.2 Ограничения по тарифам

#### Базовый тариф (0₽):
- Максимум 5 тренеров
- Базовая статистика
- Нет доступа к CRM
- Нет массовых рассылок

#### Стандарт (9900₽/мес):
- До 20 тренеров
- Полный доступ к CRM
- Массовые рассылки
- Расширенная аналитика

#### Премиум (19900₽/мес):
- Неограниченно тренеров
- API доступ
- Экспорт данных
- Персональный менеджер

### 10.3 Процесс оплаты для клубов

1. **Регистрация клуба:**
   - Автоматически на Базовом тарифе
   - 14 дней пробный период Стандарта

2. **Переход на платный тариф:**
   - Заявка через админку
   - Выставление счета
   - Активация после оплаты

3. **Продление:**
   - Автоматическое уведомление за 7 дней
   - Блокировка платных функций при неоплате
   - Сохранение данных в течение 30 дней

### 10.4 Роли и права доступа

#### Супер-админ (разработчики):
- Полный доступ ко всем данным
- Управление клубами и тарифами
- Просмотр финансовой информации
- Доступ к логам системы

#### Владелец клуба (owner):
- Полный доступ к данным клуба
- Управление администраторами
- Изменение тарифа
- Просмотр финансов клуба

#### Администратор клуба (admin):
- Управление тренерами
- Просмотр статистики
- Работа с CRM (на платных тарифах)
- Создание рассылок

#### Менеджер клуба (manager):
- Просмотр статистики
- Работа с клиентами
- Ограниченный доступ к настройкам

### 10.5 Правила работы платформы

- **Бесплатность для пользователей** - основной принцип
- Тренеры и клиенты НИКОГДА не платят за использование
- Монетизация ТОЛЬКО через клубы
- Клубы платят за расширенные бизнес-функции
- Базовый функционал клубов остается бесплатным

---

## 11. Требования к реализации {#требования}

### 11.1 Производительность
- Ответ бота < 1 секунды
- Загрузка веб-страниц < 3 секунд
- Загрузка админок < 5 секунд
- Поддержка 1000+ одновременных пользователей
- Поддержка 100+ клубов

### 11.2 Безопасность
- Двухфакторная аутентификация для админов клубов
- Разделение доступа по ролям
- Шифрование паролей (bcrypt)
- Защита от CSRF и XSS атак
- Регулярное резервное копирование
- SSL сертификаты для всех поддоменов

### 11.3 Масштабируемость
- Архитектура должна поддерживать:
  - 1000+ тренеров
  - 10000+ клиентов
  - 500+ клубов
  - 1000+ QR-кодов
  - Расширение на другие города и страны

### 11.4 Мониторинг
- Отслеживание оплат клубов
- Мониторинг использования тарифов
- Алерты при приближении к лимитам
- Отслеживание конверсии QR → запись
- Метрики роста MRR

---

## 12. Тестирование {#тестирование}

### 12.1 Подход к тестированию
- **Боевое тестирование**: Все компоненты тестируются непосредственно в продакшн окружении
- **Отсутствие отдельной тестовой среды**: Проект находится в стадии разработки, поэтому вся среда является одновременно и тестовой
- **Живая отладка**: Все изменения сразу проверяются на реальных данных

### 12.2 Разделение компонентов

#### Telegram Bot
- **Локальное тестирование**: Бот запускается локально на машине разработчика
- **Подключение**: Использует продакшн токен @TrenergramBot
- **База данных**: Подключается к единой БД проекта
- **Преимущества**:
  - Быстрая итерация и отладка
  - Просмотр логов в реальном времени
  - Возможность остановки и перезапуска без влияния на Mini App

#### Mini App
- **Деплой на сервер**: Размещается на trenergram.ru/app/
- **Автоматическое обновление**: При каждом изменении выполняется деплой
- **Доступ**: Открывается через кнопки в Telegram боте
- **API**: Подключается к backend API на том же сервере

### 12.3 Процесс тестирования

1. **Разработка функционала**
   - Изменения в коде бота тестируются локально
   - Изменения в Mini App деплоятся на сервер

2. **Проверка интеграции**
   - Регистрация новых пользователей
   - Создание записей и управление расписанием
   - Отправка уведомлений

3. **Мониторинг**
   - Просмотр логов бота в терминале
   - Проверка логов API на сервере
   - Отслеживание ошибок в реальном времени

### 12.4 Инструменты

- **SSH доступ**: Для управления процессами на сервере
- **Git**: Для версионирования и деплоя
- **PM2**: Для управления процессами на сервере
- **Логирование**: Структурированные логи для всех компонентов

---

## 13. Этапы разработки {#этапы}

### Этап 1: База и инфраструктура (1 неделя)
- [ ] Настройка сервера и домена trenergram.ru
- [ ] Создание структуры БД с таблицами клубов
- [ ] Настройка SSL и поддоменов
- [ ] Базовая структура проекта

### Этап 2: Telegram бот (2 недели)
- [ ] Базовый бот @TrenergramBot
- [ ] Регистрация тренеров/клиентов
- [ ] Привязка тренеров к клубам
- [ ] Система записи и напоминаний
- [ ] QR-коды для клубов

### Этап 3: Mini App (1 неделя)
- [x] Интерфейс для тренера
- [x] Управление расписанием
- [x] Настройки напоминаний
- [ ] Статистика тренера
- [x] Развернут на trenergram.ru/app/

### Этап 4: Веб-витрина (1 неделя)
- [ ] Главная страница с акцентом на бесплатность
- [ ] Каталог тренеров и клубов
- [ ] Страницы клубов
- [ ] Страница тарифов
- [ ] SEO оптимизация

### Этап 5: Панель администратора клуба (2 недели)
- [ ] Аутентификация и роли
- [ ] Дашборд со статистикой
- [ ] CRM функционал
- [ ] Управление тренерами
- [ ] QR-коды и аналитика
- [ ] Ограничения по тарифам

### Этап 6: Админка супер-админов (1 неделя)
- [ ] Управление клубами
- [ ] Управление тарифами и платежами
- [ ] Общая статистика платформы
- [ ] Инструменты поддержки

### Этап 7: Интеграция платежей (1 неделя)
- [ ] Подключение платежной системы
- [ ] Автоматизация выставления счетов
- [ ] Уведомления об оплатах
- [ ] История транзакций

### Этап 8: Тестирование и запуск (2 недели)
- [ ] Тестирование с 5 клубами
- [ ] Тестирование всех тарифов
- [ ] Нагрузочное тестирование
- [ ] Исправление багов
- [ ] Подготовка документации
- [ ] Мягкий запуск

### Этап 9: Маркетинг и рост (ongoing)
- [ ] Привлечение первых 10 платящих клубов
- [ ] Запуск партнерской программы
- [ ] Контент-маркетинг
- [ ] Сбор обратной связи
- [ ] Итеративные улучшения

---

## 14. Критерии приемки MVP

### Обязательные функции:

**Для всех пользователей:**
✅ Полностью бесплатное использование для тренеров и клиентов  
✅ Регистрация через бота @TrenergramBot  
✅ Поиск тренеров только через веб или прямые ссылки  

**Для тренеров:**
✅ Привязка к клубу при регистрации  
✅ Управление расписанием через Mini App  
✅ Индивидуальные настройки напоминаний  
✅ Запись клиентов на слоты  
✅ Персональные ссылки для привлечения  

**Для клубов:**
✅ Три тарифных плана (Базовый 0₽, Стандарт 9900₽, Премиум 19900₽)  
✅ QR-коды для привлечения клиентов  
✅ Панель администратора с ограничениями по тарифам  
✅ CRM на платных тарифах  
✅ Статистика и аналитика  

**Для супер-админов:**
✅ Админка для управления клубами  
✅ Управление тарифами и платежами  
✅ Мониторинг платформы  

### Метрики успешного MVP:
- 10+ клубов зарегистрировано за первый месяц
- 3+ клуба на платных тарифах за 2 месяца
- Конверсия QR → запись > 20%
- MRR > 50,000₽ за 3 месяца
- Тренеры тратят < 5 минут в день на управление
- NPS тренеров > 8/10
- Churn rate клубов < 10% в месяц

---

## Контакты и дополнительная информация

**Название проекта:** Trenergram  
**Домен:** trenergram.ru  
**Telegram бот:** @TrenergramBot  
**Бюджет MVP:** По договоренности  
**Срок разработки:** 7-8 недель  
**Поддержка после запуска:** 3 месяца включены  

---

## Приложения

### Приложение А: Примеры QR-кодов

```
QR для рецепции:
"Запишитесь на тренировку прямо сейчас!
Сканируйте QR и выбирайте тренера"

QR для зала:
"Найдите персонального тренера
Первая тренировка со скидкой 20%"

QR для раздевалки:
"Ваш идеальный тренер ждет вас
Запись за 30 секунд через Telegram"
```

### Приложение B: Тексты для лендинга

**Для тренеров:**
"Управляйте расписанием без переписок
Автоматические напоминания клиентам
100% БЕСПЛАТНО - без подписок и комиссий"

**Для клубов:**
"Привлекайте клиентов через QR-коды
CRM для управления тренерами
От 0₽ в месяц"

**Для клиентов:**
"Записывайтесь на тренировки в 2 клика
Напоминания в Telegram
Абсолютно бесплатно"

---

*Версия документа: 2.0*  
*Дата обновления: 17.09.2025*  

*Основные изменения от версии 1.3:*
- *Новое название: Trenergram (вместо FitBooking)*
- *Новый домен: trenergram.ru*
- *Новый бот: @TrenergramBot*
- *Бесплатность для тренеров и клиентов*
- *Монетизация через клубы (3 тарифа)*
- *QR-коды для привлечения*
- *Две админки: для клубов и супер-админов*
- *Расширенная CRM система*
- *Увеличен срок разработки до 7-8 недель*